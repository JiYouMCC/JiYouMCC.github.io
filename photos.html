---
layout: default
title: "相册"
---
<ol class="breadcrumb">
  <li><a href="#">Home</a></li>
  <li><a href="#">Library</a></li>
  <li class="active">Data</li>
</ol>
<div id="folders" class="row"></div>
<script type="text/javascript">
    Array.prototype.removeAll = function() {
        var what, a = arguments, L = a.length, ax;
        while (L && this.length) {
            what = a[--L];
            while ((ax = this.indexOf(what)) !== -1) {
                this.splice(ax, 1);
            }
        }
        return this;
    }

    var Photos = {
        _folders : {},
        _folderNames : [],
        init : function(imagePaths){
            for (var i = 0; i < imagePaths.length; i++) {
                var image = imagePaths[i];
                var pathArray = image.path.split("/").removeAll("");
                var folder = pathArray[1];
                image["folder"] = folder;
                if (Photos._folders[folder]) {
                    Photos._folders[folder].push(image);
                } else {
                    Photos._folders[folder] = [image];
                }
            }
            Photos._folderNames = Object.keys(Photos._folders);
        },
        clearPhotos: function() {
            $("#folders").text(" ");
        },
        setBreadcrumb: function(paths) {
            $(".breadcrumb").text("");
            for (var i = 0; i < paths.length; i++) {
                $(".breadcrumb").append(
                    $("<li></li>").append(
                        $("<a></a>").attr("breakcrumb", paths[i]).attr('href', '#').text(paths[i])
                    )
                );
            }
            $("a[breakcrumb]").click(function(){
                var breakcrumb = $(this).attr("breakcrumb");
                if (breakcrumb == "相册") {
                    Photos.showFolders();
                } else if (breakcrumb) {
                    Photos.showFolder(breakcrumb);
                }
                return false;
            });
        },
        showFolders: function() {
            Photos.clearPhotos();
            for (var i = 0; i < Photos._folderNames.length; i++) {
                $("#folders").append(
                    $("<div></div>").addClass("col-sm-6 col-md-4 photo-div").append(
                        $("<div></div>").addClass("thumbnail").append(
                            $("<img>").attr("src", Photos._folders[Photos._folderNames[i]][0].path)
                        ).append(
                            $("<a></a>").attr("folder", Photos._folderNames[i]).attr("href", "#").append(
                                $("<h1></h1>").addClass("text-center").text(Photos._folderNames[i] + " (" + Photos._folders[Photos._folderNames[i]].length + ")")
                            )
                        )
                    )
                );
            }
            $("a[folder]").click(function(){
                var folder = $(this).attr("folder");
                if (folder) {
                    Photos.showFolder(folder);
                }
                return false;
            });

            Photos.setBreadcrumb(["相册"]);
        },
        showFolder: function(folderName) {
            Photos.clearPhotos();
            for (var i = 0; i < Photos._folders[folderName].length; i++) {
                $("#folders").append(
                    $("<div></div>").addClass("col-sm-6 col-md-4 photo-div").append(
                        $("<div></div>").addClass("thumbnail").append(
                            $("<img>").attr("src", Photos._folders[folderName][i].path)
                        )
                    )
                );
            }

            Photos.setBreadcrumb(["相册", folderName]);
        }
    }

    var imageFiles = [{% assign image_files = site.static_files | where: "photo", true %}{% for myimage in image_files %}{
        "path":"{{ myimage.path }}",
        "modified_time":"{{ myimage.modified_time }}"
    },{% endfor %}];
    Photos.init(imageFiles);
    Photos.showFolders();
</script>
