---
layout: post
title:  "å¢¨å¡æ‰˜æŠ•å½±åœ°å›¾è½¬æ¢ä¸ºçƒå½¢é’©é’ˆå›¾è§£"
date:   2024-05-31 22:00:00 +0800
categories: æŠ€æœ¯
tags: ç¼–ç»‡ python PIL
use_code: true
issue: 41
---

å¾ˆä¹…ä»¥å‰æˆ‘å°±ç§è‰äº†ä¸€ä¸ªé’©é’ˆä½œå“ï¼šé’©åœ°çƒã€‚

å°çº¢ä¹¦ä¸Šæœ‰ä¸ªæ¯”è¾ƒå¥½çš„å›¾è§£ï¼š[ã€ğŸŒé’©é’ˆåœ°çƒæ‘†ä»¶ç©å¶ï¼ˆé™„å›¾è§£ï¼‰ - è‘£é˜¿èŒã€‘](https://www.xiaohongshu.com/explore/5ea2d2f2000000000100a9f0){:target="_blank"}

æˆå“å›¾æ¯”è¾ƒå¥½çœ‹çš„æœ‰

![æ‰‹å¿ƒåœ°çƒğŸŒé¥°å“/æ‘†ä»¶ã€é™„å›¾è§£ã€‘](/img/blog_103_1.jpg)

æˆå“å›¾æ¥æºï¼š [æ‰‹å¿ƒåœ°çƒğŸŒé¥°å“/æ‘†ä»¶ã€é™„å›¾è§£ã€‘](https://www.xiaohongshu.com/explore/661f24fc000000000d031d37)

å·¥ç¨‹é‡çœŸä¸å°ï¼Œæˆ‘ä¸€ç›´æ²¡æœ‰å¼€å·¥ã€‚ä½†æ˜¯æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œå¦‚æœåœ°çƒå¯ä»¥é’©ï¼Œæ˜¯ä¸æ˜¯å…«ï¼ˆä¹ï¼‰å¤§è¡Œæ˜Ÿéƒ½å¯ä»¥é’©å‘¢ï¼Ÿ

äºæ˜¯ç¨å¾®ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚çš„æˆå“å¦‚ä¸‹ï¼š

![æœˆçƒæ•ˆæœ](/img/blog_103_moon_0.jpg)

<!--more-->

## å‡†å¤‡å·¥ä½œ
### ç°æœ‰å›¾ï¼ˆæ–‡å­—ï¼‰è§£è§£æ„
åŸæœ‰çš„æ–‡å­—è§£å¦‚ä¸‹ï¼š

![åŸæ–‡å­—è§£](/img/blog_103_original_diagram.jpg)

æ¥æºæ°´å°å·²ä¿ç•™ï¼Œå…·ä½“è¿˜æ˜¯æ¥è‡ªäº[ã€ğŸŒé’©é’ˆåœ°çƒæ‘†ä»¶ç©å¶ï¼ˆé™„å›¾è§£ï¼‰ - è‘£é˜¿èŒã€‘](https://www.xiaohongshu.com/explore/5ea2d2f2000000000100a9f0){:target="_blank"}

å› ä¸ºä¸ªäººé’©ç»‡çš„ä¹ æƒ¯é—®é¢˜ï¼Œè¿™ä¸ªçœ‹äº†å¤´è¿˜æ˜¯å¾ˆç—›ã€‚æˆ‘æ¯”è¾ƒå–œæ¬¢å›¾è§£ï¼Œè€Œä¸”åœ¨åŠ é’ˆ/å‡é’ˆçš„æ—¶å€™æ¢è‰²çœŸçš„å¤ªæŠ˜ç£¨äº†ï¼Œæ‰€ä»¥ç”¨Excelå¼„äº†ä¸ªå›¾è§£å¦‚ä¸‹,åŠ äº†ä¸ªç‰¹åˆ«ä¸‘çš„æ°´å°ï¼Œå¯ç‚¹å‡»æ”¾å¤§ï¼Œè¿æ¥åœ¨ä¸€èµ·çš„è‰²å—ä»£è¡¨å‡é’ˆï¼š
[![æ•´ç†åçš„å›¾è§£](/img/blog_103_cleanup_diagram.png)](/img/blog_103_cleanup_diagram.png){:target="_blank"}

æ•´ç†åå¾—çŸ¥ï¼Œè¿™ä¸ªå›¾è§£å¤§æ¦‚æ˜¯è¿™æ ·çš„:
1. æ•´ä¸ªçƒçºµå‘åˆ†ä¸ºä¸Šä¸­ä¸‹3ä¸ªéƒ¨åˆ†
    1. ä¸Šé¢éƒ¨åˆ†8è¡Œï¼Œè¿›è¡Œäº†åŠ é’ˆçš„æ“ä½œï¼ŒåŠ é’ˆè§„å¾‹æ˜¯ç¬¬ä¸€è¡Œ6çŸ­é’ˆï¼Œåé¢æ¯è¡ŒåŠ 1é’ˆ
    2. ä¸­é—´éƒ¨åˆ†10è¡Œï¼Œä¸åŠ ä¸å‡
    3. ä¸‹é¢çš„éƒ¨åˆ†8è¡Œï¼Œè¿›è¡Œäº†å‡é’ˆçš„æ“ä½œï¼Œå‡é’ˆè§„å¾‹æ˜¯é™¤äº†ç¬¬4è¡Œï¼Œæ¯è¡Œå‡1é’ˆ
2. æ•´ä¸ªçƒæ¨ªå‘å¹³å‡åˆ†ä¸º6ä¸ªéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†æœ€å®½8é’ˆï¼Œæœ€çª„1é’ˆ

ï¼ˆè¿™æ ·æ‰“å‡ºæ¥å°±æœ‰ä¸€ç§å‚»ä¹ä¹çš„æ„Ÿè§‰:satisfied:ï¼‰

### ç´ æå›¾ç‰‡å‡†å¤‡
![ç´ æå›¾ç‰‡](/img/blog_103_source.jpg)

å¤§å¤šæ•°çš„å›¾ç‰‡æˆ‘éƒ½æ˜¯ä» [Views of the Solar System](https://solarviews.com/cap/index/maps-cylindrical1.html){:target="_blank"}è¿™ä¸ªç½‘ç«™ä¸Šä¸‹è½½çš„

å…³äºåœ°çƒçš„å›¾ç‰‡æˆ‘è¿˜å‚è€ƒäº†[Planetary maps](https://www.johnstonsarchive.net/spaceart/cylmaps.html)è¿™ä¸ªç½‘ç«™ï¼Œä¸è¿‡æœ€åè¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨

åŸæ¥è€ƒè™‘ç›´æ¥ä»NASAä¸Šä¸‹è½½ï¼Œç»“æœåè€Œå¤ªéº»çƒ¦äº†

å›¾ç‰‡çºµæ¨ªæ¯”éƒ½æ˜¯1:2ï¼Œæ¯•ç«Ÿæ˜¯å¢¨å¡æ‰˜æŠ•å½±å˜›ã€‚å¤§å¤šæ•°å¤§å°æ˜¯1440\*720ï¼Œå¤©ç‹æ˜Ÿå’Œæµ·ç‹æ˜Ÿæ˜¯720\*360ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¤§é—®é¢˜

### ä»£ç é€»è¾‘æ€è€ƒ

å…¶å®ä»£ç çš„æœ€ç»ˆéœ€æ±‚æ˜¯ï¼ŒæŠŠåŸå›¾ç¼©ç•¥æˆåªæœ‰4ä¸ªé¢œè‰²çš„å›¾å¹¶é©¬èµ›å…‹åŒ–ï¼Œåœ¨ä¸¤æçš„ä½ç½®è¿›è¡Œä¸€ä¸‹å›¾ç‰‡çš„ç¼©æ”¾

æ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ã€‚å¤§æ¦‚å°±æ˜¯è¿™äº›æ¨¡å—ï¼š

1. æŠŠåŸå›¾æ‹†åˆ†ä¸º26\*48çš„æ–¹æ ¼
2. ä¸Šé¢8è¡Œå’Œä¸‹é¢8è¡Œè¦æ ¹æ®åŠ é’ˆå’Œå‡é’ˆçš„è§„å¾‹ï¼ŒæŠŠæ¯è¡Œçš„è‰²å—åˆ†æˆä¸åŒçš„éƒ¨åˆ†
3. ä¸­é—´çš„10è¡Œæ¯ä¸€æ ¼ç‹¬ç«‹æˆä¸€ä¸ªéƒ¨åˆ†
4. æŠŠå„ä¸ªéƒ¨åˆ†çš„é¢œè‰²å…¨éƒ¨æ··æ‚æˆä¸€ä¸ªé¢œè‰²ï¼Œç”¨è¿™ä¸ªå”¯ä¸€çš„é¢œè‰²å¡«å……è¿™ä¸ªéƒ¨åˆ†
5. ç„¶åæŠŠæ•´ä¸ªå›¾ç‰‡é¢œè‰²è°ƒæ•´ä¸ºæ•´ä¸ªå›¾ç‰‡åªæœ‰4ä¸ªé¢œè‰²
6. è¾“å‡ºéœ€è¦çš„é¢œè‰²ï¼Œç»˜åˆ¶å›¾è§£

ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘è¿˜ç”»äº†è¿™ä¸ªæµ‹è¯•å›¾ç‰‡ï¼Œ5ä¸ªé¢œè‰²ï¼Œæ¨ªå‘12ä¸ªè‰²å—ï¼Œçºµå‘13ä¸ªè‰²å—ï¼š

![è‰²å—å›¾ç‰‡](/img/blog_103_color.png)

è°ƒæ•´ä¹‹åä¼šå˜æˆè¿™æ ·çš„æ•ˆæœï¼š

![è‰²å—å¡«å……å›¾ç‰‡](/img/blog_103_color_filled.png)

å¯ä»¥çœ‹åˆ°å› ä¸ºæ··è‰²æ•ˆæœï¼Œé»„è‰²å˜å¾—æ›´ç»¿ï¼Œæ•´ä¸ªå›¾ç‰‡å˜å¾—æš—æ²‰æ²‰çš„

æ‰€ä»¥åœ¨åé¢çš„ä»£ç é‡Œé¢ï¼Œæˆ‘è¿˜è°ƒæ•´äº†ä¸€ä¸‹äº®åº¦å’Œå¯¹æ¯”åº¦è®©é¢œè‰²èƒ½æ›´æ¥è¿‘åŸå›¾

![è‰²å—å¡«å……å›¾ç‰‡é«˜äº®](/img/blog_103_color_filled_light.png)

éšæ‰‹å¡«äº†2ä¸ªæ•°å€¼ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„æ•ˆæœï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™ä¸ªä¹Ÿåªæ˜¯åœ¨è§†è§‰ä¸Šè®©è‡ªå·±å¥½å—ä¸€ç‚¹ï¼Œå…·ä½“ç”Ÿæˆå›¾è§£ä¹‹åï¼Œè¿˜ä¼šå—åˆ°æ¯›çº¿è‰²å·çš„åˆ¶çº¦

### PILå‡½æ•°å‡†å¤‡

åœ¨è¿™ä¸ªâ€œé¢å‘AIç¼–ç¨‹â€çš„æ—¶ä»£ï¼Œå†™ä»£ç çœŸçš„æ˜¯è¶Šæ¥è¶Šç®€å•äº†:satisfied:ã€‚æˆ‘åœ¨Copileté‡Œé¢è¾“å…¥â€œæˆ‘æƒ³ç”¨pythonæŠŠä¸€å¼ å›¾ç‰‡é©¬èµ›å…‹åŒ–ï¼Œå¹¶ä¸”åªç”¨4ä¸ªé¢œè‰²ï¼Œä»£ç æ€ä¹ˆå†™ï¼Ÿâ€Copiletå°±å™¼å™¼å•ªå•ªå›å¤ä¸€å †ä¹±ä¸ƒå…«ç³Ÿä½†æ˜¯æŒºå¥½ç”¨çš„ä»£ç 

ä¸è¿‡æˆ‘è¿˜æ˜¯æ•´ç†äº†ä¸€ä¸‹ï¼Œä¸»è¦ç”¨åˆ°çš„å‡½æ•°ï¼š


    from PIL import Image, ImageDraw, ImageEnhance, ImageFont

- *Image.open(fp, mode='r')*

    æ‰“å¼€å›¾ç‰‡
    
- *Image.save(fp, format=None, **params)*
    
    ä¿å­˜å›¾ç‰‡
    
- *Image.convert(mode=None, matrix=None, dither=None, palette=0, colors=256)*
    
    å›¾åƒæ ¼å¼è½¬æ¢ï¼Œä¸»è¦ç”¨æ¥ç¼©è‰²
    
- *Image.resize(size, resample=0)*
    
    è°ƒæ•´å›¾åƒï¼ˆå›¾å—ï¼‰å¤§å°
    
- *Image.crop((x1, y1, x2, y2))*
    
    æˆªå–å›¾å—
    
- *Image.getpixel(self, xy)*
    
    è·å–å›¾åƒçš„åƒç´ ç‚¹ï¼Œä¸»è¦æ˜¯åé¢ç”¨æ¥å–è‰²
    
- *obj = ImageEnhance.Brightness(image)*
    
    *obj.enhance(factor)*
    
    è°ƒæ•´å›¾åƒçš„äº®åº¦
    
- *obj = ImageEnhance.Contrast(image)*
    
    *obj.enhance(factor)*
    
    è°ƒæ•´å›¾åƒçš„å¯¹æ¯”åº¦
    
- *ImageDraw.Draw(img)*
    
    å‡†å¤‡åœ¨å›¾åƒä¸Šä¹±æ¶‚ä¹±ç”»ï¼ˆbushi
    
- *ImageDraw.Draw.rectangle(xy, fill=None, outline=None)*
    
    åœ¨å›¾åƒä¸Šç»˜åˆ¶å®å¿ƒçŸ©å½¢æˆ–è€…çŸ©å½¢æ¡†
    
- *ImageDraw.Draw.text(xy, text, fill=None, font=None, anchor=None, spacing=0, align='left')*
    
    åœ¨å›¾åƒä¸Šå†™å­—

## ä»£ç 
### åŸå›¾è§£æ„

    from PIL import Image, ImageDraw, ImageEnhance, ImageFont
    import math
    import sys

    input_image_path = "00-color.png" # è¾“å…¥ç´ æå›¾è·¯å¾„
    num_colors = 4 # é”è‰²ä¸º4è‰²
    brightness_e = 1.7 # äº®åº¦è°ƒæ•´
    contrast_e = 1.7 # å¯¹æ¯”åº¦è°ƒæ•´
    outline = True # æ˜¯å¦ç”»å‡ºå¤–æ¡†

    image = Image.open(input_image_path)
    image = image.convert("RGB")
    width, height = image.size

    # è®¡ç®—çºµå‘åˆ‡ç‰‡é«˜åº¦
    double_piece_height = height/(8 + 10 + 8)

### æ‹‰ä¼¸ç»˜å›¾

    # æŠŠæŒ‡å®šè‰²å—ç»™å‹ç¼©æˆ1*1å®ç°æ··è‰²æ•ˆæœï¼Œç„¶åç”¨è¿™ä¸ªé¢œè‰²å¡«æ»¡è¿™ä¸ªè‰²å—
    def fill_color(image, x1, y1, x2, y2):
        crop_image = image.crop((x1, y1, x2, y2))
        img_small = crop_image.resize((1, 1), Image.LANCZOS)
        img_rgb = img_small.convert("RGB")
        r, g, b = img_rgb.getpixel((0, 0))
        draw = ImageDraw.Draw(image)
        draw.rectangle([(x1, y1), (x2, y2)], fill=(r, g, b))
        return image

    # ä¸Š 8è¡Œ 48 åˆ—
    # åŠ é’ˆ 1 2 3 4 5 6 7 8
    for y in range(8):
        # è®¡ç®—å½“å‰åˆ‡ç‰‡å®½åº¦
        double_piece_width = width / 6 / (y + 1.0)
        for x in range(6 * (y + 1)):
            image = fill_color(image,
                               math.ceil(double_piece_width * x),
                               math.ceil(double_piece_height * y),
                               math.ceil(double_piece_width * (x + 1)),
                               math.ceil(double_piece_height * (y + 1))
                               )

    # ä¸­ 10è¡Œ 48 åˆ—
    for y in range(10):
        double_piece_width = width / 48.0
        for x in range(48):
            image = fill_color(image,
                               math.ceil(double_piece_width * x),
                               math.ceil(double_piece_height * (y + 8)),
                               math.ceil(double_piece_width * (x + 1)),
                               math.ceil(double_piece_height * (y + 9))
                               )

    # ä¸‹ 8è¡Œ 6*48åˆ—
    # å‡é’ˆ 7 6 5 5 4 3 2 1
    for y in range(8):
        # ç¬¬å››è¡Œä¸å‡é’ˆçš„ç‰¹æ®Šæ“ä½œ
        real_y = y
        if y < 3:
            real_y += 1
        double_piece_width = width / 6 / (8.0 - real_y)
        for x in range(6 * (8 - real_y)):
            image = fill_color(image,
                               math.ceil(double_piece_width * x),
                               math.ceil(double_piece_height * (y + 18)),
                               math.ceil(double_piece_width * (x + 1)),
                               math.ceil(double_piece_height * (y + 19))
                               )

### ç¼©è‰²

    image = image.convert("P", palette=Image.ADAPTIVE, colors=num_colors)
    image = image.convert("RGB")

### è°ƒæ•´äº®åº¦å’Œå¯¹æ¯”åº¦

    brightness_enhancer = ImageEnhance.Brightness(image)
    image = brightness_enhancer.enhance(brightness_e)
    contrast_enhancer = ImageEnhance.Contrast(image)
    image = contrast_enhancer.enhance(contrast_e)

### å–è‰²è·å–æ–‡å­—è§£

    color_array = []
    color_line = []

    # ä¸Š 8è¡Œ 48 åˆ—
    for y in range(8):
        color_line = []
        double_piece_width = width / 6 / (y + 1.0)
        for x in range(6 * (y + 1)):
            r, g, b = image.getpixel((
                math.ceil(double_piece_width * x),
                math.ceil(double_piece_height * y))
            )
            color_line.append((r, g, b))
        color_array.append(color_line)

    # ä¸­ 10è¡Œ 48 åˆ—
    for y in range(10):
        color_line = []
        double_piece_width = width / 48.0
        for x in range(48):
            r, g, b = image.getpixel((
                math.ceil(double_piece_width * x),
                math.ceil(double_piece_height * (y + 8)))
            )
            color_line.append((r, g, b))
        color_array.append(color_line)

    # ä¸‹ 8è¡Œ 6*48åˆ—
    for y in range(8):
        color_line = []
        double_piece_width = width / 6 / (8.0 - y)
        for x in range(6 * (8 - y)):
            r, g, b = image.getpixel((
                math.ceil(double_piece_width * x),
                math.ceil(double_piece_height * (y + 18)))
            )
            color_line.append((r, g, b))
        color_array.append(color_line)

    for i in range(len(color_array)):
        print("[R%s] " % (i+1), end='')
        color_line = color_array[i]
        for color in color_line:
            r, g, b = color
            print('#{:02x}{:02x}{:02x}, '.format(r, g, b), end='')
        print()

è¿™æ—¶å€™è·å–çš„æ–‡å­—è§£æ˜¯è¿™æ ·çš„æ ¼å¼ï¼Œæ˜¾ç„¶å¯¹äººç±»éå¸¸ä¸å‹å¥½:dizzy_face:

    [R1] #ff0801, #00ffff, #ff0801, #ffff00, #2d67ff, #ff0801, 
    [R2] #ff0801, #ffff00, #ffff00, #00ffff, #2d67ff, #ff0801, #ffff00, #ffff00, #00ffff, #2d67ff, #ff0801, #ffff00, 
    [R3] #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #ff0801, #ff0801, 
    [R4] #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, 
    [R5] #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, 
    [R6] #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, 
    [R7] #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, 
    [R8] #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, 
    [R9] #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R10] #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R11] #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R12] #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R13] #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, 
    [R14] #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, 
    [R15] #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, 
    [R16] #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, 
    [R17] #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, 
    [R18] #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, 
    [R19] #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R20] #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, 
    [R21] #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, 
    [R22] #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ff0801, #ffff00, #ffff00, 
    [R23] #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, 
    [R24] #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #ffff00, #00ffff, #2d67ff, #2d67ff, #ff0801, #ff0801, #ffff00, #ffff00, #00ffff, #00ffff, #2d67ff, #ff0801, #ff0801, 
    [R25] #00ffff, #2d67ff, #ff0801, #ffff00, #ffff00, #00ffff, #2d67ff, #ff0801, #ffff00, #ffff00, #00ffff, #2d67ff, 
    [R26] #2d67ff, #ff0801, #00ffff, #ff0801, #ffff00, #2d67ff, 
    [Finished in 1.1s]

ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæˆ‘æ˜¯æƒ³è¦ä¸Šé¢é‚£ä¸ªExcelå·®ä¸å¤šæ ¼å¼çš„å›¾è§£å¯¹å§

### è°ƒè¯•ç”¨å¤–æ¡†ç»˜åˆ¶

å¦‚æœä¸ç»˜åˆ¶å¤–æ¡†ï¼Œè¿™é‡Œä¸€ä¸ªä¸­é—´äº§ç‰©å°±ä¼šæ˜¯åœ¨ä¸‹é¢è¿™æ ·çš„æ•ˆæœ

![è‰²å—å¡«å……å›¾ç‰‡æ— å¤–æ¡†](/img/blog_103_color_filled_nooutline.png)

æ„Ÿè§‰å¯¹äººç±»ä¸å¤ªå‹å¥½ï¼Œæ‰€ä»¥æˆ‘ç”»äº†ç‚¹æ¡†

å¦‚æœè¿™é‡Œç”¨è¡Œæ˜Ÿçš„å›¾ç‰‡ï¼Œä¼šæœ‰ä¸€ç§è«åçš„æ•™å ‚èŠ±çª—ç»ç’ƒçš„æ„Ÿè§‰

![æœ¨æ˜Ÿå½©ç»˜ç»ç’ƒ](/img/blog_103_saturncyl_outline.png)

å¥½åƒè¿˜æŒºå¥½çœ‹:sweat_smile:

    def fill_outline(image, x1, y1, x2, y2):
        draw = ImageDraw.Draw(image)
        draw.rectangle([(x1, y1), (x2, y2)], fill=None, outline="black", width=2)
        return image

    if outline:
        # ä¸Š 8è¡Œ 48 åˆ—
        for y in range(8):
            double_piece_width = width / 6 / (y + 1.0)
            for x in range(6 * (y + 1)):
                image = fill_outline(image,
                                     math.ceil(double_piece_width * x),
                                     math.ceil(double_piece_height * y),
                                     math.ceil(double_piece_width * (x + 1)),
                                     math.ceil(double_piece_height * (y + 1))
                                     )

        # ä¸­ 10è¡Œ 48 åˆ—
        for y in range(10):
            double_piece_width = width / 48.0
            for x in range(48):
                image = fill_outline(image,
                                     math.ceil(double_piece_width * x),
                                     math.ceil(double_piece_height * (y + 8)),
                                     math.ceil(double_piece_width * (x + 1)),
                                     math.ceil(double_piece_height * (y + 9))
                                     )

        # ä¸‹ 8è¡Œ 6*48åˆ—
        for y in range(8):
        # å‡é’ˆç‰¹æ®Šç®—æ³•
            real_y = y
            if y < 3:
                real_y += 1
            double_piece_width = width / 6 / (8.0 - real_y)
            for x in range(6 * (8 - real_y)):
                image = fill_outline(image,
                                     math.ceil(double_piece_width * x),
                                     math.ceil(double_piece_height * (y + 18)),
                                     math.ceil(double_piece_width * (x + 1)),
                                     math.ceil(double_piece_height * (y + 19))
                                     )

    image.save("filled_"+input_image_path)

### è®¾ç½®å›¾è§£é•¿åº¦å’Œå®½åº¦

    text_width = 50
    offset = 30
    max_length = 0
    color_block_width = 30
    font_size = 20
    font = ImageFont.truetype("arial.ttf", font_size)

    # è®¡ç®—æœ€å¤§æ¢è‰²æ¬¡æ•°
    for color_line in color_array:
        color_count = 0
        color_point = None
        for color in color_line:
            if color_point == color:
                pass
            else:
                color_point = color
                color_count +=1
        if color_count > max_length:
            max_length = color_count

    image_diagram = Image.new(mode="RGB", 
                              size=(offset + color_block_width * 48 + offset + text_width + text_width * max_length + offset,
                                    offset + color_block_width * 26 + offset), 
                              color="white")
    draw_diagram = ImageDraw.Draw(image_diagram)

### ç»˜åˆ¶å›¾è§£

    pattern_table = [
        "X       ",
        "XX      ",
        "XX   X  ",
        "XXX  X  ",
        "XXX  XX ",
        "XXXX XX ",
        "XXXX XXX",
        "XXXXXXXX",
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "X"*8,
        "XXXA XXX",
        "XXXX XA ",
        "XXA  XX ",
        "XXX  XX ",
        "XXX  A  ",
        "XA   X  ",
        "XA      ",
        "A       "
    ]

    for y in range(0, len(pattern_table)):
        flag = 0
        color_index = 0
        for x in range(0, len(pattern_table[y]*6)):
            if not pattern_table[y][x % 8].isspace():
                w = 1
                # å‡é’ˆ2å€å®½ï¼Œåæ­£å³è¾¹æ²¡ä¸œè¥¿äº†
                if pattern_table[y][x % 8] == "A":
                    w = 2
                draw_diagram.rectangle(
                    [(x * color_block_width + offset, y * color_block_width + offset),
                    ((x + w) * color_block_width + offset, (y + 1) * color_block_width + offset)],
                    fill=color_array[y][flag], outline="black", width=1)
                flag += 1
        color_count = 0
        color_point = None
        index = 1

        # ç”»æ–‡å­—è§£
        # è¡Œå·
        draw_diagram.rectangle([
                (offset + (x + 1) * color_block_width + offset + text_width * color_index,
                y * color_block_width + offset),
                (offset + (x + 1) * color_block_width + offset + text_width * (color_index + 1),
                y * color_block_width + offset + offset)
            ],
            fill=None,
            outline="black",
            width=1)
        draw_diagram.text(
            xy=(offset + (x + 1) * color_block_width + offset + text_width * color_index + font_size/4,
                y * color_block_width + offset + font_size/4),
            text = 'R'+str(y+1), 
            fill = "black", 
            font = font)

        # æ–‡å­—å’Œæ¡†
        for i in range(0, len(color_array[y])):
            color = color_array[y][i]
            if color_point:
                if color == color_point:
                    color_count += 1
                else:
                    draw_diagram.rectangle(
                        [
                            (offset + (x + 1) * color_block_width + offset + text_width * (color_index + 1),
                             y * color_block_width + offset),
                            (offset + (x + 1) * color_block_width + offset + text_width * (color_index + 2),
                             y * color_block_width + offset + color_block_width)
                        ],
                        fill=None,
                        outline="black",
                        width=1)
                    draw_diagram.text(
                        xy=(offset + (x + 1) * color_block_width + offset + text_width * (color_index + 1)  + font_size/4,
                            y * color_block_width + offset + font_size/4),
                        text=str(color_count)+'X',
                        fill=color,
                        font=font
                    )
                    color_point = color
                    color_count = 1
                    color_index += 1
            else:
                color_point = color
                color_count += 1
        draw_diagram.rectangle(
                        [
                            (offset + (x + 1) * color_block_width + offset + text_width * (color_index + 1),
                             y * color_block_width + offset),
                            (offset + (x + 1) * color_block_width + offset + text_width * (color_index + 2),
                             y * color_block_width + offset + color_block_width)
                        ],
                        fill=None,
                        outline="black",
                        width=1)
        draw_diagram.text(
                        xy=(offset + (x + 1) * color_block_width + offset + text_width * (color_index + 1)  + font_size/4,
                            y * color_block_width + offset + font_size/4),
                        text=str(color_count)+'X',
                        fill=color,
                        font=font
                    )
    image_diagram.save("diagram_" + input_image_path)

## å›¾è§£æˆå“

æˆ‘æ ¹æ®è‡ªå·±çš„å–œå¥½è°ƒæ•´äº†ä¸€ä¸‹äº®åº¦å’Œå¯¹æ¯”åº¦

è‡³äºæ°´å°å·²ç»æ‡’å¾—ä¸Šäº†ï¼Œå› ä¸ºæ­£å¸¸äººçœ‹äº†è¿™ä¸ªå›¾è§£ä¹Ÿé’©ä¸å‡ºæ¥ï¼Œé¢œè‰²å¤ªæ¥è¿‘äº†ï¼Œè‚‰çœ¼å¤ªéš¾çœ‹æ¸…æ¥šäº†ï¼Œå¿…é¡»è¦å’Œæ–‡å­—ç‰ˆé…åˆæ‰è¡Œ

å¦‚æœæœ‰æ„Ÿå…´è¶£çš„äººå¯ä»¥è‡ªå·±ç”¨ä»£ç è·‘äº†è¯•è¯•ç»“æœ

### äº”è‰²è‰²å—å›¾ï¼ˆç”¨æ¥è°ƒè¯•ï¼‰
![äº”è‰²è‰²å—å›¾å›¾è§£](/img/blog_103_diagram_00-color.png)

äº®åº¦=1.7

å¯¹æ¯”åº¦=1.7

### å¤ªé˜³
![å¤ªé˜³å›¾è§£](/img/blog_103_diagram_11-suncyl1.png)

äº®åº¦=1.3

å¯¹æ¯”åº¦=1.3
### æœˆçƒ
![æœˆçƒå›¾è§£](/img/blog_103_diagram_10-moonmap.png)

äº®åº¦=1.1

å¯¹æ¯”åº¦=1.3

### æ°´æ˜Ÿ
![æ°´æ˜Ÿå›¾è§£](/img/blog_103_diagram_01-mercurycyl2.png)

äº®åº¦=1

å¯¹æ¯”åº¦=1

### é‡‘æ˜Ÿ
![é‡‘æ˜Ÿå›¾è§£](/img/blog_103_diagram_02-venuscyl2.png)

äº®åº¦=1

å¯¹æ¯”åº¦=1

### åœ°çƒï¼ˆæ— å†°ç›–ï¼‰
![åœ°çƒæ— å†°ç›–å›¾è§£](/img/blog_103_diagram_03-earthcyl1.png)

äº®åº¦=0.7

å¯¹æ¯”åº¦=3

### ç«æ˜Ÿ
![ç«æ˜Ÿå›¾è§£](/img/blog_103_diagram_04-marscyl1.png)

äº®åº¦=0.9

å¯¹æ¯”åº¦=1.5

### åœŸæ˜Ÿ
![åœŸæ˜Ÿå›¾è§£](/img/blog_103_diagram_06-saturncyl1.png)

äº®åº¦=1

å¯¹æ¯”åº¦=1

### æœ¨æ˜Ÿ
![æœ¨æ˜Ÿå›¾è§£](/img/blog_103_diagram_05-jupitercyl2.png)

äº®åº¦=1.3

å¯¹æ¯”åº¦=1

### å¤©ç‹æ˜Ÿ
![å¤©ç‹æ˜Ÿå›¾è§£](/img/blog_103_diagram_07-uranuscyl1.png)

äº®åº¦=1

å¯¹æ¯”åº¦=1

### æµ·ç‹æ˜Ÿ
![æµ·ç‹æ˜Ÿå›¾è§£](/img/blog_103_diagram_08-neptunecyl1.png)

äº®åº¦=0.9

å¯¹æ¯”åº¦=1.1

:satisfied: å›¾è§£ç”Ÿæˆå¥½äº†ï¼Œæˆ‘å‡ ä¹å®Œå…¨æ²¡æœ‰é’©å‡ºæ¥çš„æ¬²æœ›äº†ã€‚å“¦å¤©ç‹æ˜Ÿå’Œæµ·ç‹æ˜Ÿå¥½åƒæŒºç®€å•çš„ï¼Œè¯´ä¸å®šå“ªå¤©å¯ä»¥åŠ¨æ‰‹è¯•ä¸€è¯•â€¦â€¦